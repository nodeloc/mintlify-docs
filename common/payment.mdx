---
title: NodeLoc Payment å¯¹æ¥æŒ‡å—
description: å®Œæ•´çš„æ”¯ä»˜é›†æˆæ–‡æ¡£ï¼ŒåŠ©æ‚¨å¿«é€Ÿæ¥å…¥ NodeLoc æ”¯ä»˜ç³»ç»Ÿ
---

## å¿«é€Ÿå¼€å§‹

### å¯¹æ¥æµç¨‹

1. **åˆ›å»ºæ”¯ä»˜åº”ç”¨** â†’ è·å– Payment ID å’Œ Secret Key
2. **ç”¨æˆ·ä¸‹å•** â†’ è°ƒç”¨å‘èµ·æ”¯ä»˜æ¥å£
3. **è·³è½¬æ”¯ä»˜** â†’ ç”¨æˆ·åœ¨ NodeLoc ç™»å½•å¹¶æ”¯ä»˜
4. **æ¥æ”¶å›è°ƒ** â†’ æµè§ˆå™¨è·³è½¬åˆ°ä½ çš„å›è°ƒåœ°å€
5. **æŸ¥è¯¢çŠ¶æ€**ï¼ˆå¯é€‰ï¼‰â†’ ä¸»åŠ¨æŸ¥è¯¢æ”¯ä»˜ç»“æœ

---

## åˆ›å»ºæ”¯ä»˜åº”ç”¨

### è®¿é—®ç®¡ç†é¡µé¢

```
https://www.nodeloc.com/payment/applications
```

### å¡«å†™åº”ç”¨ä¿¡æ¯

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **åº”ç”¨åç§°** | ä½ çš„ç½‘ç«™/å•†åº—åç§° | "æˆ‘çš„åœ¨çº¿å•†åº—" |
| **ç½‘ç«™åœ°å€** | ä½ çš„ç½‘ç«™ä¸»é¡µ | `https://example.com` |
| **å›è°ƒåœ°å€** | æ¥æ”¶æ”¯ä»˜é€šçŸ¥çš„URL | `https://example.com/payment/callback` |
| **æè¿°** | åº”ç”¨è¯´æ˜ï¼ˆå¯é€‰ï¼‰ | "åœ¨çº¿å•†åº—æ”¯ä»˜é›†æˆ" |

### ä¿å­˜å¯†é’¥

åˆ›å»ºæˆåŠŸåä¼šæ˜¾ç¤ºï¼š

- **Payment ID**: `pay_xxxxxxxxxxxxxxxxxx`
- **Secret Key**: `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

<Warning>
Secret Key åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·ç«‹å³ä¿å­˜ï¼
</Warning>

---

## å‘èµ·æ”¯ä»˜

### API æ¥å£

```
POST https://www.nodeloc.com/payment/pay/:payment_id/process
```

### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `amount` | Integer | æ˜¯ | æ”¯ä»˜é‡‘é¢ï¼ˆç§¯åˆ†ï¼‰ |
| `description` | String | æ˜¯ | äº¤æ˜“æè¿° |
| `order_id` | String | æ˜¯ | ä½ çš„è®¢å•å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ |
| `signature` | String | æ˜¯ | HMAC-SHA256 ç­¾å |

### ç­¾åç®—æ³•

1. **å‡†å¤‡å‚æ•°**: `amount`, `description`, `order_id`
2. **æŒ‰é”®åæ’åº**: å­—æ¯é¡ºåºæ’åˆ—å‚æ•°
3. **æ‹¼æ¥å­—ç¬¦ä¸²**: æ ¼å¼ `key1=value1&key2=value2&key3=value3`
4. **ç”Ÿæˆç­¾å**: `HMAC-SHA256(secret_key, param_string)`

**ç­¾åå‚æ•°ç¤ºä¾‹**ï¼š
```
amount=100&description=è´­ä¹°VIPä¼šå‘˜&order_id=order_20251008_001
```

### å“åº”æ•°æ®

æˆåŠŸæ—¶è¿”å›ï¼š

```json
{
  "payment_url": "https://www.nodeloc.com/payment/pay/txn_xxx",
  "transaction_id": "txn_xxx",
  "status": "pending",
  "amount": 100
}
```

### è·³è½¬æ”¯ä»˜

å°†ç”¨æˆ·é‡å®šå‘åˆ°å“åº”ä¸­çš„ `payment_url`ï¼Œç”¨æˆ·ä¼šï¼š

1. è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µï¼ˆå¦‚æœªç™»å½•ï¼‰
2. ç™»å½•åè¿”å›æ”¯ä»˜é¡µé¢
3. ç¡®è®¤è®¢å•å¹¶å®Œæˆæ”¯ä»˜
4. æ”¯ä»˜æˆåŠŸåè·³è½¬åˆ°ä½ çš„å›è°ƒåœ°å€

---

## å¤„ç†å›è°ƒ

### å›è°ƒæ–¹å¼

<Warning>
**é‡è¦**ï¼šè¿™æ˜¯æµè§ˆå™¨ GET è·³è½¬ï¼Œä¸æ˜¯æœåŠ¡å™¨ POST è¯·æ±‚ï¼
</Warning>

æ”¯ä»˜æˆåŠŸåï¼Œç”¨æˆ·æµè§ˆå™¨ä¼šè·³è½¬åˆ°ä½ è®¾ç½®çš„å›è°ƒåœ°å€ï¼Œæ‰€æœ‰å‚æ•°ä»¥æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼ä¼ é€’ã€‚

### å›è°ƒå‚æ•°ï¼ˆURL æŸ¥è¯¢å‚æ•°ï¼‰

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `transaction_id` | String | äº¤æ˜“ID |
| `external_reference` | String | ä½ çš„è®¢å•å·ï¼ˆå³ order_idï¼‰ |
| `amount` | Integer | æ”¯ä»˜é‡‘é¢ï¼ˆç§¯åˆ†ï¼‰ |
| `platform_fee` | Integer | å¹³å°æ‰‹ç»­è´¹ï¼ˆç§¯åˆ†ï¼‰ |
| `merchant_points` | Integer | å•†å®¶å®é™…æ”¶åˆ°çš„ç§¯åˆ† |
| `status` | String | äº¤æ˜“çŠ¶æ€ï¼ˆ`completed`ï¼‰ |
| `paid_at` | DateTime | æ”¯ä»˜æ—¶é—´ï¼ˆISO 8601ï¼‰ |
| `signature` | String | å›è°ƒç­¾åï¼ˆç”¨äºéªŒè¯ï¼‰ |

### å›è°ƒ URL ç¤ºä¾‹

```
https://example.com/payment/callback?
  transaction_id=txn_xxx&
  external_reference=order_123&
  amount=100&
  platform_fee=5&
  merchant_points=95&
  status=completed&
  paid_at=2025-10-08T12:00:00Z&
  signature=abc123...
```

### éªŒè¯ç­¾å

<Warning>
**å¿…é¡»éªŒè¯ç­¾å**ï¼Œé˜²æ­¢ä¼ªé€ è¯·æ±‚ï¼
</Warning>

éªŒè¯æ­¥éª¤ï¼š

1. **æå–ç­¾åå‚æ•°**: ä» URL ä¸­è·å– `signature`
2. **æå–å…¶ä»–å‚æ•°**: æ‰€æœ‰å‚æ•°é™¤äº† `signature` æœ¬èº«
3. **æŒ‰é”®åæ’åº**: å­—æ¯é¡ºåºæ’åˆ—
4. **æ‹¼æ¥å­—ç¬¦ä¸²**: æ ¼å¼ `key1=value1&key2=value2...`
5. **è®¡ç®—ç­¾å**: `HMAC-SHA256(secret_key, param_string)`
6. **æ¯”å¯¹ç­¾å**: è®¡ç®—å‡ºçš„ç­¾åä¸æ¥æ”¶åˆ°çš„ç­¾åå¿…é¡»å®Œå…¨ä¸€è‡´

**ç­¾åå‚æ•°ç¤ºä¾‹**ï¼š
```
amount=100&external_reference=order_123&merchant_points=95&paid_at=2025-10-08T12:00:00Z&platform_fee=5&status=completed&transaction_id=txn_xxx
```

### å¤„ç†è®¢å•

éªŒè¯ç­¾åé€šè¿‡åï¼š

- âœ… **æ£€æŸ¥å¹‚ç­‰æ€§**: ç¡®ä¿è®¢å•æœªè¢«é‡å¤å¤„ç†
- âœ… **éªŒè¯é‡‘é¢**: ç¡®è®¤ `amount` ä¸è®¢å•é‡‘é¢ä¸€è‡´
- âœ… **æ›´æ–°è®¢å•çŠ¶æ€**: æ ‡è®°ä¸ºå·²æ”¯ä»˜
- âœ… **æ‰§è¡Œä¸šåŠ¡é€»è¾‘**: å‘è´§ã€å¼€é€šæœåŠ¡ç­‰
- âœ… **æ˜¾ç¤ºç¡®è®¤é¡µé¢**: å‘ç”¨æˆ·å±•ç¤ºæ”¯ä»˜æˆåŠŸä¿¡æ¯

---

## æŸ¥è¯¢çŠ¶æ€

å¦‚æœå›è°ƒå¤±è´¥æˆ–éœ€è¦ä¸»åŠ¨ç¡®è®¤æ”¯ä»˜çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨æŸ¥è¯¢æ¥å£ã€‚

### API æ¥å£

```
POST https://www.nodeloc.com/payment/query/:payment_id
```

### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `transaction_id` | String | æ˜¯ | äº¤æ˜“ID |
| `signature` | String | æ˜¯ | HMAC-SHA256 ç­¾å |

### ç­¾åç®—æ³•

ä¸å‘èµ·æ”¯ä»˜ç›¸åŒï¼š

1. å‚æ•°ï¼š`transaction_id`
2. æ‹¼æ¥ï¼š`transaction_id=txn_xxx`
3. ç­¾åï¼š`HMAC-SHA256(secret_key, param_string)`

### å“åº”æ•°æ®

```json
{
  "transaction_id": "txn_xxx",
  "status": "completed",
  "amount": 100,
  "platform_fee": 5,
  "merchant_points": 95,
  "description": "è´­ä¹°VIPä¼šå‘˜",
  "external_reference": "order_123",
  "created_at": "2025-10-08T12:00:00Z",
  "updated_at": "2025-10-08T12:05:00Z",
  "paid_at": "2025-10-08T12:05:00Z",
  "expires_at": "2025-10-08T12:30:00Z",
  "expired": false,
  "error_message": null
}
```

### äº¤æ˜“çŠ¶æ€

| çŠ¶æ€ | è¯´æ˜ |
|------|------|
| `pending` | ç­‰å¾…ç”¨æˆ·æ”¯ä»˜ |
| `processing` | æ”¯ä»˜å¤„ç†ä¸­ |
| `completed` | æ”¯ä»˜æˆåŠŸ |
| `failed` | æ”¯ä»˜å¤±è´¥ |
| `cancelled` | å·²å–æ¶ˆ |
| `refunded` | å·²é€€æ¬¾ |

### å»ºè®®ä½¿ç”¨åœºæ™¯

- å®šæ—¶ä»»åŠ¡æ£€æŸ¥å¾…æ”¯ä»˜è®¢å•çŠ¶æ€
- ç”¨æˆ·ä¸»åŠ¨æŸ¥è¯¢è®¢å•çŠ¶æ€
- å›è°ƒå¤±è´¥åçš„è¡¥æ•‘æªæ–½

---

## å®‰å…¨å»ºè®®

### 1. ä¿æŠ¤å¯†é’¥
- âŒ ä¸è¦ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡

### 2. ä½¿ç”¨ HTTPS
- âœ… ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS
- âœ… å›è°ƒ URL å¿…é¡»æ˜¯ HTTPS åœ°å€

### 3. éªŒè¯ç­¾å
- âœ… æ‰€æœ‰å›è°ƒè¯·æ±‚å¿…é¡»éªŒè¯ç­¾å
- âœ… ç­¾åä¸åŒ¹é…æ—¶æ‹’ç»è¯·æ±‚

### 4. é˜²æ­¢é‡å¤å¤„ç†
- âœ… æ£€æŸ¥è®¢å•çŠ¶æ€ï¼Œé˜²æ­¢é‡å¤å¤„ç†
- âœ… ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿åŸå­æ€§

### 5. éªŒè¯é‡‘é¢
- âœ… éªŒè¯å›è°ƒé‡‘é¢ä¸è®¢å•é‡‘é¢ä¸€è‡´
- âœ… é‡‘é¢ä¸åŒ¹é…æ—¶è®°å½•æ—¥å¿—å¹¶å‘Šè­¦

### 6. æ—¥å¿—è®°å½•
- âœ… è®°å½•æ‰€æœ‰æ”¯ä»˜ç›¸å…³æ“ä½œ
- âœ… è®°å½•æ‰€æœ‰å›è°ƒè¯·æ±‚ï¼ˆåŒ…æ‹¬ç­¾åéªŒè¯å¤±è´¥çš„ï¼‰

---

## å¸¸è§é—®é¢˜

<AccordionGroup>
  <Accordion title="Q: ç­¾åéªŒè¯å¤±è´¥ï¼Ÿ">
    æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
    1. å‚æ•°æ˜¯å¦æŒ‰é”®åå­—æ¯é¡ºåºæ’åº
    2. å‚æ•°æ‹¼æ¥æ ¼å¼æ˜¯å¦ä¸º `key=value&key=value`
    3. Secret Key æ˜¯å¦æ­£ç¡®
    4. éªŒè¯æ—¶æ˜¯å¦æ’é™¤äº† `signature` å‚æ•°æœ¬èº«
    5. å­—ç¬¦ç¼–ç æ˜¯å¦ä¸€è‡´ï¼ˆUTF-8ï¼‰
  </Accordion>

  <Accordion title="Q: å›è°ƒæ²¡æœ‰æ”¶åˆ°ï¼Ÿ">
    å¯èƒ½åŸå› ï¼š
    1. å›è°ƒ URL è®¾ç½®é”™è¯¯
    2. ç”¨æˆ·å…³é—­äº†æµè§ˆå™¨çª—å£
    3. ç½‘ç»œé—®é¢˜å¯¼è‡´è·³è½¬å¤±è´¥

    **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æŸ¥è¯¢æ¥å£å®šæœŸæ£€æŸ¥è®¢å•çŠ¶æ€
  </Accordion>

  <Accordion title="Q: å¦‚ä½•æµ‹è¯•ï¼Ÿ">
    å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼š
    1. ä½¿ç”¨ ngrok ç­‰å·¥å…·æš´éœ²æœ¬åœ°æœåŠ¡å™¨
    2. åœ¨ NodeLoc åˆ›å»ºæµ‹è¯•åº”ç”¨
    3. è®¾ç½®å›è°ƒ URL ä¸º ngrok åœ°å€
    4. åˆ›å»ºå°é‡‘é¢è®¢å•æµ‹è¯•
  </Accordion>

  <Accordion title="Q: æ”¯æŒé€€æ¬¾å—ï¼Ÿ">
    ç›®å‰ä¸æ”¯æŒè‡ªåŠ¨é€€æ¬¾ï¼Œéœ€è¦è”ç³»ç®¡ç†å‘˜æ‰‹åŠ¨å¤„ç†ã€‚
  </Accordion>

  <Accordion title="Q: è®¢å•ä¼šè¿‡æœŸå—ï¼Ÿ">
    æ˜¯çš„ï¼Œé»˜è®¤ 30 åˆ†é’Ÿæœªæ”¯ä»˜ä¼šè‡ªåŠ¨è¿‡æœŸã€‚
  </Accordion>
</AccordionGroup>

---

## API å‚è€ƒ

### å‘èµ·æ”¯ä»˜

- **URL**: `POST /payment/pay/:payment_id/process`
- **è®¤è¯**: ç­¾åéªŒè¯
- **è¯·æ±‚**: `amount`, `description`, `order_id`, `signature`
- **å“åº”**: `payment_url`, `transaction_id`, `status`, `amount`

### æŸ¥è¯¢çŠ¶æ€

- **URL**: `POST /payment/query/:payment_id`
- **è®¤è¯**: ç­¾åéªŒè¯
- **è¯·æ±‚**: `transaction_id`, `signature`
- **å“åº”**: å®Œæ•´äº¤æ˜“ä¿¡æ¯ï¼ˆè§ä¸Šæ–‡ï¼‰

### æ”¯ä»˜å›è°ƒ

- **æ–¹å¼**: æµè§ˆå™¨ GET è·³è½¬
- **URL**: ä½ è®¾ç½®çš„ `callback_url`
- **è®¤è¯**: ç­¾åéªŒè¯
- **å‚æ•°**: `transaction_id`, `external_reference`, `amount`, `platform_fee`, `merchant_points`, `status`, `paid_at`, `signature`

---

**ç¥å¯¹æ¥é¡ºåˆ©ï¼** ğŸš€